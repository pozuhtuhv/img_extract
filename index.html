<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>IMG SRC 추출 → 공백 없는 스택 변환</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea { width: 100%; height: 180px; margin-bottom: 10px; }
    button { padding: 10px 16px; margin: 4px 8px 16px 0; cursor: pointer; }
    .code-box {
      background:#f6f6f6; border:1px solid #ccc; padding:10px;
      white-space:pre-wrap; word-break:break-all; margin-bottom: 16px;
    }
    /* 미리보기: 페이지 맨 아래 */
    .stack-preview {
      text-align:center; max-width:1000px; margin: 24px auto 0;
      line-height:0; font-size:0;
    }
    .stack-preview img {
      width:100%; height:auto; display:block; margin:0; padding:0; border:0; vertical-align:top;
    }
  </style>
</head>
<body>
  <h2>HTML IMG SRC 추출 → 스택 코드 생성</h2>
  <textarea id="htmlInput" placeholder="HTML 코드를 붙여넣으세요 (여기서 img src만 추출합니다)"></textarea><br/>
  <button onclick="run()">추출 & 코드생성</button>
  <button onclick="copyCode()">코드 복사</button>

  <!-- 복사용 코드 출력 (위) -->
  <div id="codeOutput" class="code-box"></div>

  <!-- 미리보기 (맨 아래) -->
  <div id="preview"></div>

<script>
function run() {
  const raw = document.getElementById('htmlInput').value || '';

  // HTML 파싱
  const parser = new DOMParser();
  const doc = parser.parseFromString(raw, 'text/html');

  // 1) IMG src 추출
  const urls = Array.from(doc.querySelectorAll('img[src]'))
    .map(el => el.getAttribute('src'));

  // 2) YouTube iframe 원문 보존 추출 (여러 개면 모두 포함)
const youtubeIframes = Array.from(doc.querySelectorAll('iframe[src]'))
  .filter(el => /(?:youtube\.com|youtu\.be)/i.test(el.getAttribute('src') || ''))
  .map(el => `<div style="display:flex; justify-content:center;">${el.outerHTML.trim()}</div>`);

  const codeBox = document.getElementById('codeOutput');
  const preview = document.getElementById('preview');

  if (urls.length === 0 && youtubeIframes.length === 0) {
    codeBox.textContent = '';
    preview.innerHTML = "<p style='color:#d00'>img 또는 유튜브 iframe을 찾지 못했습니다.</p>";
    return;
  }

  // 3) 이미지 스택 HTML 생성
  const openDiv = '<div style="text-align:center; max-width:100%; margin:0 auto; line-height:0; font-size:0;">';
  const imgTag = (u) => `<img src="${u}" style="width:100%; height:auto; display:block; margin:0; padding:0; border:0; vertical-align:top;">`;
  const closeDiv = '</div>';
  const stackHtml = urls.length ? openDiv + urls.map(imgTag).join('') + closeDiv : '';

  // 4) 최종 출력 형식: (iframe...) + \n + (이미지 스택)
  const finalHtml = [youtubeIframes.join('\n'), stackHtml].filter(Boolean).join('\n');

  // 5) 복사용 코드 + 미리보기
  codeBox.textContent = finalHtml;
  const previewStack = urls.length ? `<div class="stack-preview">${urls.map(imgTag).join('')}</div>` : '';
  preview.innerHTML = [youtubeIframes.join(''), previewStack].join('');
}
</script>

</body>
</html>
